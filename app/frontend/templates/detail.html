{% extends "base.html" %}

{% block content %}
      <form method="POST" name="portauth">

  <div class="row">
    <div class="large-12 columns">
      <table>
        <tr>
          <th>Hostname</th>
          <th>Model</th>
          <th>Firmware</th>
          <th>Port Auth Enabled</th>
        </tr>
        
        <tr>
          <td>{{ device.hostname }}</td>
          <td>{{ device.model() }}</td>
          <td>{{ device.firmware() }}</td>
          <td>
            <select name="802.1x-enabled">
              <option value="1" {% if device.port_auth_enabled()  %}selected{% endif %}>Yes</option>
              <option value="2" {% if not device.port_auth_enabled() %}selected{% endif %}>No</option>
            </select>
          </td>
        </tr>
      </table>
    </div>
  </div>
  <div class="row">
    <div class="large-12 columns">
        <p>
        <input type="hidden" name="hostname" value="{{ device.hostname }}" />
      {% for port in device.get_ports() %}
        {% if port.idx() is odd and port.is_interface() %}
          <span class="{% if port.is_up() %}success{% endif %} label">{{ port.descr() }}<br/>
            <input type="checkbox" id="port-{{ port.idx() }}" onChange="toggle_port_auth({{ port.idx() }});" name="port-{{ port.idx() }}" value="{{ port.idx() }}" {% if port.has_port_auth() %} checked="checked"{% endif %} />
            <input type="hidden"   name="port-auth-{{ port.idx() }}" id="port-auth-{{ port.idx() }}" {% if port.has_port_auth() %} value="true" {% else %} value="false" {% endif %} />
          </span>
          {% endif %}
        {% endfor %}
        <br/>
        <br/>
        {% for port in device.get_ports() %}
          {% if port.idx() is even and port.is_interface() %}
          <span class="{% if port.is_up() %}success{% endif %} label">{{ port.descr() }}<br/>
            <input type="checkbox" id="port-{{ port.idx() }}" onChange="toggle_port_auth({{ port.idx() }});" name="port-{{ port.idx() }}" value="{{ port.idx() }}" {% if port.has_port_auth() %} checked="checked"{% endif %} />
            <input type="hidden"   name="port-auth-{{ port.idx() }}" id="port-auth-{{ port.idx() }}" {% if port.has_port_auth() %} value="true" {% else %} value="false" {% endif %} />
          </span>
          {% endif %}
        {% endfor %}
        <br/>
        </p>
        <input class="button" type="submit">
        </form>
    </div>
  </div>
{% endblock %}
{% block jsscript %}
  function toggle_port_auth(idx) {
      var port_auth = document.getElementById('port-'+idx).checked;
      if (port_auth == false) {
          document.getElementById('port-auth-'+idx).value = 'false';
          console.log("value: false");
      }
      else {
          document.getElementById('port-auth-'+idx).value = 'true';
          console.log("value: true");
      }
  }
{% endblock %}
